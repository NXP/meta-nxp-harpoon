From 7c05ff49b632f4541451dc8ea0245663a088c520 Mon Sep 17 00:00:00 2001
From: Zineb El Azzouzi <zineb.elazzouzi@nxp.com>
Date: Thu, 9 Feb 2023 19:04:12 +0100
Subject: [PATCH 48/64] arm64: update imx8mp to support rpmsg

Signed-off-by: Zineb El Azzouzi <zineb.elazzouzi@nxp.com>
---
 configs/arm64/imx8mp-harpoon-rtos.h | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

diff --git a/configs/arm64/imx8mp-harpoon-rtos.h b/configs/arm64/imx8mp-harpoon-rtos.h
index 2daa8aaa..2fdade78 100644
--- a/configs/arm64/imx8mp-harpoon-rtos.h
+++ b/configs/arm64/imx8mp-harpoon-rtos.h
@@ -1,7 +1,7 @@
 /*
  * i.MX8MP target - common RTOS config
  *
- * Copyright 2021-2022 NXP
+ * Copyright 2021-2023 NXP
  *
  * Authors:
  *  Stephane Viau <stephane.viau@nxp.com>
@@ -21,6 +21,8 @@ typedef enum IRQn {
   I2S3_IRQn                    = 82,               /**< SAI3 Receive / Transmit Interrupt */
   GPT2_IRQn                    = 86,               /**< OR of GPT Rollover interrupt line, Input Capture 1 and 2 lines, Output Compare 1, 2, and 3 Interrupt lines */
   GPT1_IRQn                    = 87,               /**< OR of GPT Rollover interrupt line, Input Capture 1 and 2 lines, Output Compare 1, 2, and 3 Interrupt lines */
+  SW_MB_L_IRQn                 = 108,              /**< Unused SPI 76, to be used by generic software mailbox in Linux */
+  SW_MB_R_IRQn                 = 109,              /**< Unused SPI 77, to be used by generic software mailbox in RTOS */
   I2S56_IRQn                   = 122,              /**< SAI5/6 Receive / Transmit Interrupt */
   I2S1_IRQn                    = 127,              /**< SAI1 Receive / Transmit Interrupt */
   I2S2_IRQn                    = 128,              /**< SAI2 Receive / Transmit Interrupt */
@@ -38,6 +40,9 @@ typedef enum IRQn {
 	MEM_REGION_RWS( 0xfd9fc000, 0xfd9fc000, KB(8)),  /* IVSHMEM */              \
 	MEM_REGION_ROS( 0xfd9fe000, 0xfd9fe000, KB(8)),  /* IVSHMEM */              \
 	/* IVSHMEM regions should always be kept on top so PCI_IVS doesn't change */\
+	MMIO_REGION_RWS(0xfe000000, 0xfe000000, KB(4)),  /* SW MBOX */              \
+	MMIO_REGION_RWS(0xfe100000, 0xfe100000, KB(64)), /* RPMSG */                \
+	MEM_REGION_RWS( 0xfe200000, 0xfe200000, MB(1)),  /* RPMSG BUF */            \
 	MMIO_REGION_ROS(0x30270000, 0x30270000, KB(64)), /* ANA_OSC */              \
 	MMIO_REGION_RW( 0x302d0000, 0x302d0000, KB(64)), /* GPT1 */                 \
 	MMIO_REGION_RW( 0x302e0000, 0x302e0000, KB(64)), /* GPT2 */                 \
@@ -109,7 +114,7 @@ typedef enum IRQn {
 
 /* interrupts 96..127 */
 #define RTOS_COMMON_IRQCHIP0_BITMAP3 \
-	0
+		IRQnMAP(SW_MB_R_IRQn)
 #define RTOS_AUDIO_IRQCHIP0_BITMAP3 \
 		IRQnMAP(I2S56_IRQn) | /* SAI5-6 */ \
 		IRQnMAP(I2S1_IRQn)    /* SAI1 */
-- 
2.34.1

