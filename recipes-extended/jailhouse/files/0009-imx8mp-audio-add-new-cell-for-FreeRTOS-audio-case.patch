From cb8a0b316d3d4cd13cd385fffadcd9e48814313e Mon Sep 17 00:00:00 2001
From: Jiafei Pan <Jiafei.Pan@nxp.com>
Date: Wed, 1 Dec 2021 12:07:10 +0800
Subject: [PATCH 09/43] imx8mp-audio: add new cell for FreeRTOS audio case

Signed-off-by: Jiafei Pan <Jiafei.Pan@nxp.com>
---
 configs/arm64/imx8mp-freertos-audio.c | 57 +++++++++++++++++++++++++++
 1 file changed, 57 insertions(+)
 create mode 100644 configs/arm64/imx8mp-freertos-audio.c

diff --git a/configs/arm64/imx8mp-freertos-audio.c b/configs/arm64/imx8mp-freertos-audio.c
new file mode 100644
index 00000000..19cb0a6c
--- /dev/null
+++ b/configs/arm64/imx8mp-freertos-audio.c
@@ -0,0 +1,57 @@
+/*
+ * i.MX8MP target - FreeRTOS
+ *
+ * Copyright 2021 NXP
+ *
+ * Authors:
+ *  Stephane Viau <stephane.viau@nxp.com>
+ *  Fabrice Goucem <fabrice.goucem@nxp.com>
+ *  Jiafei Pan <Jiafei.Pan@nxp.com>
+ *
+ * This work is licensed under the terms of the GNU GPL, version 2.  See
+ * the COPYING file in the top-level directory.
+ */
+
+#include "cell-helper.h"
+#include "imx8mp-rtos.h"
+
+/* Name, cores, entry point */
+#define CONFIG_INMATE_NAME		"freertos"
+#define CONFIG_INMATE_CORE_BITMAP	(0b1000)
+#define CONFIG_INMATE_BASE		(0xc0000000)
+
+/* Memory & peripherals */
+#define CONFIG_INMATE_REGIONS_NUM	(RTOS_COMMON_MEMORY_REGIONS_NUM + 14)
+#define CONFIG_INMATE_REGIONS		\
+	RTOS_COMMON_MEMORY_REGIONS,                                     \
+	MEM_REGION_RWXL(0xc0000000, 0xc0000000, MB(16)),   /* RAM */    \
+	MEM_REGION_RWX( 0x00900000, 0x00900000, KB(384)),  /* OCRAM */  \
+	MEM_REGION_RW(  0x00800000, 0x00800000, KB(128)),  /* DTCM */   \
+	MEM_REGION_RWX( 0x007e0000, 0x007e0000, KB(128)),  /* ITCM */   \
+	MMIO_REGION_RW( 0x30240000, 0x30240000, KB(64)),   /* GPIO5 */	\
+	MMIO_REGION_RWS(0x30360000, 0x30360000, KB(4)),    /* ANA_PLL */\
+	MMIO_REGION_RWS(0x30384000, 0x30384000, KB(4)),    /* CCM */    \
+	MMIO_REGION_RWS(0x30388000, 0x30388000, KB(12)),   /* CCM */    \
+	MMIO_REGION_RW( 0x303a0000, 0x303a0000, KB(64)),   /* GPC */	\
+	MMIO_REGION_RWS(0x30a40000, 0x30a40000, KB(64)),   /* I2C3 */	\
+	MMIO_REGION_RWS(0x30c30000, 0x30c30000, KB(64)),   /* SAI3 */	\
+	MMIO_REGION_RWS(0x30c50000, 0x30c50000, KB(64)),   /* SAI5 */	\
+	MMIO_REGION_RWS(0x30e20000, 0x30e20000, KB(64))    /* AUDIOMIX */
+
+/* GIC */
+#define CONFIG_INMATE_IRQCHIPS_NUM	(RTOS_COMMON_IRQCHIPS_NUM)
+#define CONFIG_INMATE_IRQCHIPS_ADDR	(0x38800000)
+#define CONFIG_INMATE_IRQCHIPS_BASE	(32)
+#define CONFIG_INMATE_IRQCHIPS_BITMAP	\
+	/* interrupts 32..63 */         \
+	RTOS_COMMON_IRQCHIPS_BITMAP1,   \
+	/* interrupts 64..95 */         \
+	RTOS_COMMON_IRQCHIPS_BITMAP2 |   \
+	(1 << (50 + 32 - 64)), /* SAI3 */ \
+	/* interrupts 96..127 */        \
+	RTOS_COMMON_IRQCHIPS_BITMAP3 |   \
+	(1 << (90 + 32 - 96)), /* SAI5 */ \
+	/* interrupts 128..159 */       \
+	RTOS_COMMON_IRQCHIPS_BITMAP4
+
+#include "cell-create.h"
-- 
2.25.1

