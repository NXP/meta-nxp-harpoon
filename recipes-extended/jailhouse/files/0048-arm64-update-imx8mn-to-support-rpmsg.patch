From b618335cfbdb12d7d7f5150db4010de97597ca3b Mon Sep 17 00:00:00 2001
From: Zineb El Azzouzi <zineb.elazzouzi@nxp.com>
Date: Thu, 9 Feb 2023 18:56:16 +0100
Subject: [PATCH 48/68] arm64: update imx8mn to support rpmsg

Signed-off-by: Zineb El Azzouzi <zineb.elazzouzi@nxp.com>
---
 configs/arm64/imx8mn-harpoon-rtos.h | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

diff --git a/configs/arm64/imx8mn-harpoon-rtos.h b/configs/arm64/imx8mn-harpoon-rtos.h
index 68db53e2..e048cbe1 100644
--- a/configs/arm64/imx8mn-harpoon-rtos.h
+++ b/configs/arm64/imx8mn-harpoon-rtos.h
@@ -1,7 +1,7 @@
 /*
  * i.MX8MN target - common RTOS config
  *
- * Copyright 2021-2022 NXP
+ * Copyright 2021-2023 NXP
  *
  * Authors:
  *  Stephane Viau <stephane.viau@nxp.com>
@@ -22,6 +22,8 @@ typedef enum IRQn {
   I2S3_IRQn                    = 82,               /**< SAI3 Receive / Transmit Interrupt */
   GPT2_IRQn                    = 86,               /**< OR of GPT Rollover interrupt line, Input Capture 1 and 2 lines, Output Compare 1, 2, and 3 Interrupt lines */
   GPT1_IRQn                    = 87,               /**< OR of GPT Rollover interrupt line, Input Capture 1 and 2 lines, Output Compare 1, 2, and 3 Interrupt lines */
+  SW_MB_L_IRQn                 = 108,              /**< Unused SPI 76, to be used by generic software mailbox in Linux */
+  SW_MB_R_IRQn                 = 109,              /**< Unused SPI 77, to be used by generic software mailbox in RTOS */
   I2S56_IRQn                   = 122,              /**< SAI5/6 Receive / Transmit Interrupt */
   I2S2_IRQn                    = 128,              /**< SAI2 Receive / Transmit Interrupt */
   I2S7_IRQn                    = 143,              /**< SAI7 Receive / Transmit Interrupt */
@@ -38,6 +40,9 @@ typedef enum IRQn {
 	MEM_REGION_RWS( 0xbbafc000, 0xbbafc000, KB(8)),  /* IVSHMEM */              \
 	MEM_REGION_ROS( 0xbbafe000, 0xbbafe000, KB(8)),  /* IVSHMEM */              \
 	/* IVSHMEM regions should always be kept on top so PCI_IVS doesn't change */\
+	MMIO_REGION_RWS(0xb8500000, 0xb8500000, KB(4)),  /* SW MBOX */              \
+	MMIO_REGION_RWS(0xb8600000, 0xb8600000, KB(64)), /* RPMSG */                \
+	MEM_REGION_RWS( 0xb8700000, 0xb8700000, MB(1)),  /* RPMSG BUF */            \
 	MMIO_REGION_RW( 0x302d0000, 0x302d0000, KB(64)), /* GPT1 */                 \
 	MMIO_REGION_RW( 0x302e0000, 0x302e0000, KB(64)), /* GPT2 */                 \
 	MMIO_REGION_RWS(0x30330000, 0x30330000, KB(64)), /* IOMUXC */               \
@@ -94,7 +99,7 @@ typedef enum IRQn {
 
 /* interrupts 96..127 */
 #define RTOS_COMMON_IRQCHIP0_BITMAP3 \
-	0
+		IRQnMAP(SW_MB_R_IRQn)
 #define RTOS_AUDIO_IRQCHIP0_BITMAP3 \
 		IRQnMAP(I2S56_IRQn)  /* SAI5-6 */
 #define RTOS_AVB_IRQCHIP0_BITMAP3 \
-- 
2.34.1

